// Generated by CoffeeScript 1.10.0
(function() {
  $(function() {
    var compute_result, display_pending, editor, keys, print_result;
    editor = ace.edit("editor");
    keys = {};
    editor.setTheme("ace/theme/twilight");
    editor.getSession().setMode("ace/mode/ruby");
    document.getElementById('editor').style.fontSize = '14px';
    compute_result = function() {
      var code;
      code = editor.session.getDocument().getAllLines();
      display_pending();

      return $.ajax({
        url: '/editors/evaluate',
        type: 'POST',
        data: {
          'code': code
        },
        success: function(response) {
          keys = {};
          print_result(response.result);
        }
      });
    };

    display_pending = function() {
      $("#result").text("處理中...");
    };

    print_result = function(text) {
      $("#result").text(text);
    };

    compute_result();
    $("#tip").hide();
    $("#send").click(function() {
      $("#tip").show();
      return compute_result();
    });

    return $("#editor").keydown(function(key) {
      keys[key.which] = true;
      if (keys.hasOwnProperty(13) === true && keys.hasOwnProperty(91) === true) {
        $("#tip").hide();
        compute_result();
      }
      return $("#editor").keyup(function(key) {
        return delete keys[key.which];
      });
    });
  });

}).call(this);
